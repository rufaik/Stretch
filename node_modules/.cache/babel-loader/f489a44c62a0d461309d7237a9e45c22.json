{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _regenerator = require('babel-runtime/regenerator');\n\nvar _regenerator2 = _interopRequireDefault(_regenerator);\n\nvar _asyncToGenerator2 = require('babel-runtime/helpers/asyncToGenerator');\n\nvar _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _isomorphicFetch = require('isomorphic-fetch');\n\nvar _isomorphicFetch2 = _interopRequireDefault(_isomorphicFetch);\n\nvar _noop = require('./noop');\n\nvar _noop2 = _interopRequireDefault(_noop);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar ZapierForm = function (_React$Component) {\n  (0, _inherits3.default)(ZapierForm, _React$Component);\n\n  function ZapierForm(props) {\n    (0, _classCallCheck3.default)(this, ZapierForm);\n\n    var _this = (0, _possibleConstructorReturn3.default)(this, (ZapierForm.__proto__ || Object.getPrototypeOf(ZapierForm)).call(this, props));\n\n    _this.state = {\n      error: false,\n      loading: false,\n      success: false\n    };\n    _this.onSubmit = _this.onSubmit.bind(_this);\n    _this.onSuccess = _this.onSuccess.bind(_this);\n    _this.onError = _this.onError.bind(_this);\n    return _this;\n  }\n\n  (0, _createClass3.default)(ZapierForm, [{\n    key: 'onSubmit',\n    value: function () {\n      var _ref = (0, _asyncToGenerator3.default)(\n      /*#__PURE__*/\n      _regenerator2.default.mark(function _callee(e) {\n        var data, notValid, res, body;\n        return _regenerator2.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                e.preventDefault();\n\n                if (!(!this.props.canSubmit || this.honeypot.value)) {\n                  _context.next = 3;\n                  break;\n                }\n\n                return _context.abrupt('return');\n\n              case 3:\n                this.setState({\n                  loading: true,\n                  error: false,\n                  success: false\n                });\n                data = new FormData(this.form);\n                _context.next = 7;\n                return this.props.validate(data);\n\n              case 7:\n                notValid = _context.sent;\n\n                if (!notValid) {\n                  _context.next = 10;\n                  break;\n                }\n\n                return _context.abrupt('return', this.setState({\n                  loading: false,\n                  error: false,\n                  success: false\n                }));\n\n              case 10:\n                this.props.onSubmit(data);\n                res = void 0;\n                body = void 0;\n                _context.prev = 13;\n                _context.next = 16;\n                return (0, _isomorphicFetch2.default)(this.props.action, {\n                  method: 'post',\n                  body: data\n                });\n\n              case 16:\n                res = _context.sent;\n                _context.next = 22;\n                break;\n\n              case 19:\n                _context.prev = 19;\n                _context.t0 = _context['catch'](13);\n                return _context.abrupt('return', this.onError('Connection error'));\n\n              case 22:\n                if (!(res.status !== 200)) {\n                  _context.next = 24;\n                  break;\n                }\n\n                return _context.abrupt('return', this.onError('Error code ' + res.statusText));\n\n              case 24:\n                _context.prev = 24;\n                _context.next = 27;\n                return res.json();\n\n              case 27:\n                body = _context.sent;\n                _context.next = 33;\n                break;\n\n              case 30:\n                _context.prev = 30;\n                _context.t1 = _context['catch'](24);\n                return _context.abrupt('return', this.onError('Error parsing JSON'));\n\n              case 33:\n                if (!(body.status !== 'success')) {\n                  _context.next = 35;\n                  break;\n                }\n\n                return _context.abrupt('return', this.onError(body));\n\n              case 35:\n                this.onSuccess(res);\n\n              case 36:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[13, 19], [24, 30]]);\n      }));\n\n      function onSubmit(_x) {\n        return _ref.apply(this, arguments);\n      }\n\n      return onSubmit;\n    }()\n  }, {\n    key: 'onSuccess',\n    value: function onSuccess(body) {\n      this.props.onSuccess(body);\n      this.setState({\n        loading: false,\n        success: body,\n        error: false\n      });\n    }\n  }, {\n    key: 'onError',\n    value: function onError(err) {\n      console.error(err);\n      this.props.onError(err);\n      return this.setState({\n        loading: false,\n        error: err,\n        success: false\n      });\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      return _react2.default.createElement('form', (0, _extends3.default)({\n        ref: function ref(form) {\n          return _this2.form = form;\n        },\n        onSubmit: this.onSubmit\n      }, this.formProps), _react2.default.createElement('div', {\n        style: {\n          display: 'none'\n        }\n      }, _react2.default.createElement('input', {\n        type: 'text',\n        name: this.props.honeyPotName,\n        ref: function ref(honeypot) {\n          return _this2.honeypot = honeypot;\n        }\n      })), this.props.children(this.state));\n    }\n  }]);\n  return ZapierForm;\n}(_react2.default.Component);\n\nZapierForm.defaultProps = {\n  canSubmit: true,\n  honeyPotName: 'p_number',\n  onSubmit: _noop2.default,\n  onSuccess: _noop2.default,\n  onError: _noop2.default,\n  validate: _noop2.default\n};\nexports.default = ZapierForm;","map":null,"metadata":{},"sourceType":"script"}